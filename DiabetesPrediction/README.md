# DiabetesPrediction 모델 비교

## **프로젝트 개요**
본 프로젝트는 aiFactory 플랫폼의 경진대회에서 시작되었습니다.
기존 대회목표처럼 당뇨병 여부를 분류하는 문제를 해결하기 위해 초기에는 의사결정나무(Decision Tree)와 랜덤 포레스트(Random Forest)와 같은 기본 모델을 구현하였고, 이후 다양한 머신러닝 알고리즘을 추가하고, 각각의 성능을 비교함으로써 **의료 데이터 특성에 적합한 최적의 알고리즘을 설계**하는 실습을 진행하였습니다.

이 프로젝트의 핵심 목표는 **Recall(재현율) 최적화**입니다. 단순 데이터 기반으로 초기 단순 질병 여부를 예측하는 의료 데이터의 특성을 고려할 때, 당뇨병 진단에서 놓치는 False Negative(위양성) 사례를 최소화하는 것이 무엇보다 중요합니다. 이는 초기 진단 단계에서 재현율을 높임으로써 정밀 검사가 필요한 대상을 선별하는 데 중점을 두기 위함입니다. 본 README에서는 모델 선택의 이유, 주요 결과, 그리고 프로젝트 진행 과정에서 얻은 교훈을 체계적으로 설명합니다.

## **사용한 모델과 의료 분류 문제에서의 적합성**
### 1. Decision Tree, DT
  - 간단하면서도 해석 가능한 모델로, 초기 실험에 적합.
  - 그러나 데이터가 불균형할 경우 과적합(overfitting)의 위험이 높음.
  - 성능 비교를 위한 기준 모델로 사용.
### 2. Random Forest, RF
  - 다수의 의사결정나무를 앙상블로 결합하여 과적합을 줄이고 일반화 성능을 향상.
  - class_weight='balanced_subsample' 파라미터를 추가하여 불균형 데이터를 효과적으로 처리.
### 3. Gradient Boosting, GB
  - 이전 모델의 오류를 순차적으로 수정하며 복잡한 패턴을 학습.
  - 불균형 데이터에서 재현율을 최적화하는 데 강점을 가짐.
### 4. Support Vector Machine, SVM
  - 고차원 특징 공간에서도 효과적인 성능을 발휘.
  - 커널 튜닝을 통해 비선형 관계를 학습 가능.
### 5. Naive Bayes, NB
  - 독립 가정 하에서 작동하는 단순 확률 모델로, 계산량이 적어 빠르게 작동.
  - 비교 기준으로 포함.
### 6. Voting Classifier / 앙상블
  - 모든 모델의 강점을 결합한 앙상블 학습 기법.
  - 가중치를 최적화하여 성능을 향상.

## **주요 구현 내용**
### 1. **특징 선택 (Feature Selection)**
  - 랜덤 포레스트를 사용해 특징 중요도를 계산하고, 중요도가 특정 임계값 이상인 특징만 선택.
  -  상위 주요 특징:
    -  혈장 포도당 농도 (plas)
    -  체질량 지수 (mass)
    -  나이 (age)
### 2. **하이퍼파라미터 최적화**     //수정
  - **초기 방법**: GridSearchCV를 사용해 모든 조합을 탐색.  **->**  **문제점**: 조합 수가 많아 학습 시간이 지나치게 길어짐.
  - **개선 방법**: RandomizedSearchCV를 활용해 일부 조합을 무작위로 탐색하여 학습 시간을 단축.
    - 약간의 성능 저하가 있었으나, 시간 대비 효율성을 확보.
### 3. **평가 지표**
  - 의료 데이터의 특성을 고려해 재현율(Recall) 최적화를 중점적으로 평가.
  -  사용된 주요 지표:
    - **정확도(Accuracy)**
    - **정밀도(Precision)**
    - **재현율(Recall)**
    - **F1 점수(F1-Score)**
  - **ROC-AUC 곡선**을 생성하여 모델 비교.

## **프로젝트 중 배운 점과 도전 과제**
### 1. 성능과 계산 시간의 균형
  - GridSearchCV와 RandomizedSearchCV의 차이를 학습하며, 탐색 방법에 따른 성능-효율성 트레이드오프를 경험.
  - 옵션 수를 줄이는 과정에서 성능 저하가 있었지만, 공부라는 본 프로젝트의 목적에 맞게 현실적인 시간 내에 모델을 학습할 수 있도록 하였음
### 2. 로깅(logging)을 통한 가독성 향상
  - 학습로그 가독성을 높이기 위한 도전 과제 중 print를 대신하는 logging이라는 모듈을 접하고 익히고이를 도입하여 도입해 모델 학습 및 평가 로그의 가독성을 개선.
  - 이 과정에서 고급 로깅 기법에 대한 학습 필요성을 느꼈음.
### 3. 문제 특성에 따른 모델 최적화 실습
  - 위에서 언급한 문제 특성에 따른 재현율 최적화를 통해 당뇨병 환자를 놓치지 않는 결과를 도출.
  - 프로젝트의 수준과 목표에 맞는 가중치 조정과 파라미터 튜닝을 통해 더욱 실용적인 결과를 얻음.

## **결과요약 (실행결과)**
![Heatmap](https://github.com/user-attachments/assets/e9808ade-b1c6-46da-9082-0517bd7c1277)

![roc_auc_curve](https://github.com/user-attachments/assets/988afc2e-3854-486c-8ec5-e4771fedb993)


